<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css" integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ"
    crossorigin="anonymous">
  <link rel="stylesheet" href="./../../css/style.css">
  <link rel="stylesheet" href="./../../css/programs/coffe.css">
</head>

<body>
  <div class="nav">
    <div id="bread-crumps"></div>
    <div class="search">
      <span>&#64;</span>
      <input type="text">
      <button>search</button>
    </div>
  </div>
  <div class="header">
    <div id="menu"></div>
  </div>
  <!-- here -->
  <div class="coffe-wrap cfx">
    <div class="coffe">
      <div class="coffe-mech">
        <div class="socket">
          <button class="socket-power">
            <div class="socket-indikator"></div>
            <div class="socket-in">
              <span></span>
              <span></span>
            </div>
          </button>
          <div class="socket-cable"></div>
        </div>
        <div class="coffe-machine">
          <div class="shlang"></div>
          <div class="water">
            <div class="water-top">
              <div class="water-mount">
                <img src="../../assets/water.jpeg" alt="">
              </div>
              <ul class="machine-fill">
                <li class="machine-fill-item power-indicator">
                  <img src="../../assets/lamp.png" alt="">
                  <span>Power</span>
                </li>
                <li class="machine-fill-item water-indicator">
                  <img src="../../assets/lamp.png" alt="">
                  <span>Water</span>
                </li>
                <li class="machine-fill-item coffe-indicator">
                  <img src="../../assets/lamp.png" alt="">
                  <span>Coffe</span>
                </li>
              </ul>
              <div class="machine-water-count">----</div>
            </div>
            <div class="water-bottom">
              <div class="power-button"></div>
              <div class="power-display disc"></div>
            </div>
          </div>
          <div class="beans">
            <div class="mounty-beans-wrap">
              <div class="machine-coffe-count">----</div>
              <div class="mount-beans">
                <img src="../../assets/coffe.jpeg" alt="">
              </div>
            </div>
            <div class="mount-coffe">
              <div class="mount-coffe-img">
                <div class="mount-coffe-img-wrap">
                  <img src="../../assets/5.jpg" alt="">
                  <img src="../../assets/5.jpg" alt="">
                </div>
              </div>
              <div class="pot-handler"></div>
              <div class="pot-cap"></div>
              <div class="pot-neck">&lt;</div>
              <div class="pot-coffe-mount"></div>
              <div class="pot-stand"></div>
              <ul class="pot-amount">
                <li>&nbsp; 300 mg</li>
                <li>&nbsp; 200 mg</li>
                <li>&nbsp; 100 mg</li>
              </ul>
            </div>
            <div class="warming">
              <div class="coffe-cap-size-switcher sm"></div>
              <form action="coffe-cap-size" class="coffe-cap-size-list">
                <div class="cap-size-item">
                  <input class="cap-size" name="cap-size" data-cup="expresso" type="radio" disabled="true" checked>
                  <label for="sm">esspresso</label>
                </div>
                <div class="cap-size-item">
                  <input class="cap-size" name="cap-size" data-cup="americano" type="radio" disabled="true">
                  <label for="md">americano</label>
                </div>
                <div class="cap-size-item">
                  <input class="cap-size" name="cap-size" data-cup="latte" type="radio" disabled="true">
                  <label for="lg">latte</label>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="coffe-cup-wrap">
          <img src="../../assets/dim2.png" alt="">
          <div class="coffe-cup">good day <span></span></div>
        </div>
        <div class="coffe-instruction">
          <h2>Инструкция:</h2>
          <ul>
            <li>Включите в розетку</li>
            <li>Залейте воды</li>
            <li>Насыпте коффе</li>
            <li>Выберите напиток</li>
            <li>Нажмите пуск</li>
            <li>Налейте кофе в чашку</li>
            <li>Не забудьте его выпить <br>(после процесс можно повторить)</li>
            <li>Если закончится вода или кофе - <br>просто долейте или досыпте</li>
          </ul>
        </div>
      </div>
      <div class="coffe-table">
        <div class="coffe-table-top"></div>
        <div class="coffe-table-foot-left"></div>
        <div class="coffe-table-foot-right"></div>
      </div>
    </div>
    <div class="coffe-code">  
      <pre class="code">
        <code>
          // Machine 
          let Machine = function () { 
            this.mountWater = 0; 
            this.mountCoffe = 0; 
            this.maxWater = 800; 
            this.maxCoffe = 160;

            this.power = false; 
            this.powerOn = () => this.power = true; 
            this.powerOff = () => this.power = false; 

            this.readyKettle = false; 
            this.readyKettleOn = () => this.readyKettle = true; 
            this.readyKettleOff = () => this.readyKettle = false; 

            this.readyCoffe = false; 
            this.readyCoffeOn = () => this.readyCoffe = true; 
            this.readyCoffeOff = () => this.readyCoffe = false; 

            this.water = false; 
            this.waterOn = () => this.water = true; 
            this.waterOff = () => this.water = false; 

            this.coffe = false; 
            this.coffeOn = () => this.coffe = true; 
            this.coffeOff = () => this.coffe = false; 
          }; 
          
          // Coffe 
          let Coffe = function () { 
            Machine.call(this); //наследование контекста Machine
            
            this.machinePower = document.querySelector('.socket'); 
            this.waterMount = document.querySelector('.water-mount');
            this.imgWaterMount = document.querySelector('.water-mount img'); 
            this.coffeMount = document.querySelector('.mount-beans');

            this.imgCoffeMount = document.querySelector('.mount-beans img'); 
            this.getCoffeCup = document.querySelector('.power-button');
            this.elemKettle = document.querySelector('.mount-coffe'); 
            this.powerDisplay = document.querySelector('.power-display'); 
            this.coffeCup = document.querySelector('.coffe-cup-wrap'); 
            this.coffeCupReady = document.querySelector('.coffe-cup span'); 
            this.coffeSmoke = document.querySelector('.coffe-cup-wrap img'); 
            this.powerIndicator = document.querySelector('.power-indicator'); 
            this.waterIndicator = document.querySelector('.water-indicator'); 
            this.coffeIndicator = document.querySelector('.coffe-indicator'); 
            this.waterCountElem = document.querySelector('.machine-water-count'); 
            this.coffeCountElem = document.querySelector('.machine-coffe-count'); 
            this.setCoffeCup = document.querySelector('.coffe-cap-size-switcher'); 
            this.handspikeCoffe = document.querySelectorAll('.cap-size-item');
            this.machinePower.addEventListener('click', this.getPower.bind(this) ); 
            this.waterMount.addEventListener('click', this.fillWater.bind(this)); 
            this.coffeMount.addEventListener('click', this.fillCoffe.bind(this)); 
            this.getCoffeCup.addEventListener('click', this.getCoffe.bind(this)); 
            this.elemKettle.addEventListener('click', this.takeCoffe.bind(this)); 
            this.setCoffeCup.addEventListener('click', this.setCoffeCupClosure.bind(this)); 
            this.coffeCup.addEventListener('click', this.drinkCoffe.bind(this)); 
          }; 
          
          Coffe.prototype.fillWater = function () { 
            this.imgWaterMount.style.transform = 'translateY(-5%)'; 
            this.waterIndicator.classList.add('active'); 
            this.mountWater = this.maxWater; 
            this.waterCountElem.innerHTML = coffe.mountWater; 
            if (!this.water) this.waterOn(); 
          }; 
          
          Coffe.prototype.fillCoffe = function () { 
            this.imgCoffeMount.style.transform = 'translateY(0%)'; 
            this.coffeIndicator.classList.add('active'); 
            this.mountCoffe = this.maxCoffe; 
            this.coffeCountElem.innerHTML = this.mountCoffe; 
            if (!this.coffe) this.coffeOn(); 
          }; 
          
          Coffe.prototype.getPower = function () { 
            this.powerIndicator.classList.toggle('active');
            
            !this.power ? this.powerOn() : this.powerOff(); 
            this.powerDisplay.classList.toggle('conc'); 
            this.powerDisplay.classList.toggle('disc');
            this.waterCountElem.classList.toggle('active'); 
            this.coffeCountElem.classList.toggle('active'); 
            this.machinePower.classList.toggle('active');
            this.getCoffeCup.classList.toggle('active');    
          }; 
          
          // select coffe closure 
          Coffe.prototype.selectCoffe = function() { 
            let handspikeRadiusDeg = -25, 
            handspikeStep = -1; 
            return function () { 
              let last = this.handspikeCoffe.length - 1; 
              handspikeRadiusDeg += 25; 
              handspikeStep++; 
              if (handspikeStep == last) { 
                handspikeRadiusDeg = -25; 
                handspikeStep = -1;
            
                this.handspikeCoffe[last].getElementsByTagName('input')[0].removeAttribute('checked', 'checked'); this.handspikeCoffe[0].getElementsByTagName('input')[0].setAttribute('checked', 'checked');
              } else { 
                this.handspikeCoffe[handspikeStep].getElementsByTagName('input')[0].removeAttribute('checked', 'checked');

                this.handspikeCoffe[handspikeStep].nextElementSibling.getElementsByTagName('input')[0].setAttribute('checked', 'checked');
              }; 
              
              this.setCoffeCup.style.transform = 'rotate(' + handspikeRadiusDeg + 'deg)'; 
            }; 
          }; 
          
          // call back function setCup 
          Coffe.prototype.setCup = function(getCoffeSize) { 
            switch (getCoffeSize) { 
              case ('expresso'): 
                this.outWater = 100; 
                this.outCoffe = 30; 
                break; 
              case ('americano'): 
                this.outWater = 200; 
                this.outCoffe = 40; 
                break; 
              case ('latte'): 
                this.outWater = 300; 
                this.outCoffe = 50; 
                break;
              default: 
                this.outWater = 0; 
            } 
          }; 
            
          // method - remain coffe 
          Coffe.prototype.remain = function () { 
            this.mountCoffe -= this.outCoffe;
            this.mountWater -= this.outWater;

            this.rateCoffe = 100 - (this.mountCoffe * 100 / this.maxCoffe); 
            this.rateWater = 100 - (this.mountWater * 100 / this.maxWater); 
            this.waterCountElem.innerHTML = this.mountWater; 
            this.coffeCountElem.innerHTML = this.mountCoffe; 
          }; 
          
          // display coffe machine 
          Coffe.prototype.textDisplay = function(getCoffeCup) { 
            let className = this.powerDisplay.classList[0];
            let oldClassName = this.powerDisplay.classList[1]; 
            this.powerDisplay.classList = className + ' ' + getCoffeCup; 
            setTimeout( () => this.powerDisplay.classList = className + ' ' + oldClassName, 1800); 
          }; 
          
          // check cup size 
          Coffe.prototype.checkCupSize = function() { 
            for (let i = 0; i < this.handspikeCoffe.length; i++) { 
              let input=this.handspikeCoffe[i].getElementsByTagName('input')[0]; 
              if ( input.hasAttribute( 'checked', 'checked') ) return input.getAttribute( 'data-cup'); 
            } 
          }; 
          
          // prepare coffe 
          Coffe.prototype.getCoffe=function () { 
            if (!this.power) return this.textDisplay('npow'); 
            if (!this.water || this.mountWater<=300) return this.textDisplay('fw'); 
            if (!this.coffe || this.mountCoffe <=50) return this.textDisplay('fc'); 
            
            if (this.readyKettle) return this.textDisplay('kettle-ready'); 
            this.textDisplay('wait'); 
            this.elemKettle.classList=this.elemKettle.classList[0] + ' ' + this.checkCupSize(); 
            this.setCup(this.checkCupSize() ); 
            this.remain(); 
            this.readyKettleOn(); 
            this.imgWaterMount.style.transform='translateY(' + this.rateWater + '%)'; this.imgCoffeMount.style.transform='translateY(' + this.rateCoffe + '%)'; 
          }; 
          Coffe.prototype.takeCoffe=function() { 
            if (!this.readyKettle) return this.textDisplay('empty'); 
            if (this.readyCoffe) return this.textDisplay('coffe-ready'); 
            this.readyKettleOff(); 
            this.readyCoffeOn(); 
            this.coffeCupReady.innerHTML='ready'; 
            this.elemKettle.style.animation='take-coffe 5s'; 
            
            setTimeout( ()=> this.elemKettle.classList = this.elemKettle.classList[0], 2500 ); 
            setTimeout( () => this.elemKettle.style.animation='', 5000 ); 
            setTimeout( () => this.coffeSmoke.style.opacity = 1, 4000 ); 
          }; 
          
          Coffe.prototype.drinkCoffe = function() { 
            this.readyCoffe ? this.readyCoffeOff() : this.textDisplay('empty'); 
            this.coffeSmoke.style.opacity = 0; 
            this.coffeCupReady.innerHTML = '';
          };
          
          Coffe.prototype.setCoffeCupClosure = Coffe.prototype.selectCoffe(); 
          let machine = new Machine; 
          let coffe = new Coffe();
        </code>
      </pre>
    </div>
  </div>

  <!-- end -->
  <script src="../../js/main/hilight.js"></script>
  <script src="./../../js/main/dynamic.js"></script>
  <script src="./../../js/main/main.js"></script>
  <script src="./../../js/programs/coffe.js"></script>
</body>

</html>